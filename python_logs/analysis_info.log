[INFO] 2021-09-06 08:42:02 - Loading data sets ...
[INFO] 2021-09-06 08:42:02 - Loading dataset from ./datasets/cic-ids2017/train_set.parquet
[INFO] 2021-09-06 08:42:02 - Dataset shape: (440632, 85)
[INFO] 2021-09-06 08:42:03 - Dataset shape after feature selection: (440632, 69)
[INFO] 2021-09-06 08:42:03 - Loading dataset from ./datasets/cic-ids2017/crossval_set.parquet
[INFO] 2021-09-06 08:42:04 - Dataset shape: (220312, 85)
[INFO] 2021-09-06 08:42:04 - Dataset shape after feature selection: (220312, 69)
[INFO] 2021-09-06 08:42:04 - Loading dataset from ./datasets/cic-ids2017/test_set.parquet
[INFO] 2021-09-06 08:42:04 - Dataset shape: (220312, 85)
[INFO] 2021-09-06 08:42:05 - Dataset shape after feature selection: (220312, 69)
[INFO] 2021-09-06 08:42:05 - Normalizing training set ...
[INFO] 2021-09-06 08:42:06 - Normalizing crossval set ...
[INFO] 2021-09-06 08:42:06 - Normalizing test set ...
[INFO] 2021-09-06 08:42:06 - Loading data sets ...
[INFO] 2021-09-06 08:42:06 - Loading dataset from ./datasets/lycos-ids2017/train_set.parquet
[INFO] 2021-09-06 08:42:06 - Dataset shape: (440632, 83)
[INFO] 2021-09-06 08:42:07 - Dataset shape after feature selection: (440632, 74)
[INFO] 2021-09-06 08:42:07 - Loading dataset from ./datasets/lycos-ids2017/crossval_set.parquet
[INFO] 2021-09-06 08:42:07 - Dataset shape: (220312, 83)
[INFO] 2021-09-06 08:42:08 - Dataset shape after feature selection: (220312, 74)
[INFO] 2021-09-06 08:42:08 - Loading dataset from ./datasets/lycos-ids2017/test_set.parquet
[INFO] 2021-09-06 08:42:08 - Dataset shape: (220312, 83)
[INFO] 2021-09-06 08:42:09 - Dataset shape after feature selection: (220312, 74)
[INFO] 2021-09-06 08:42:09 - Normalizing training set ...
[INFO] 2021-09-06 08:42:10 - Normalizing crossval set ...
[INFO] 2021-09-06 08:42:10 - Normalizing test set ...
[INFO] 2021-09-06 08:42:10 - ------------------------------------------
[INFO] 2021-09-06 08:42:10 - MLP
[INFO] 2021-09-06 08:42:10 - Training ...
[INFO] 2021-09-06 08:42:10 - Creating neural network ...
[INFO] 2021-09-06 08:42:10 - Model name: mlp_lycos-ids2017
[INFO] 2021-09-06 08:42:10 - n_epochs: 25
[INFO] 2021-09-06 08:42:10 - activation function: selu
[INFO] 2021-09-06 08:42:10 - dropout_rate: 0.11859054480832958
[INFO] 2021-09-06 08:42:10 - optim_params: [0.0003175219400915149, 0.9158410351985389, 0.999]
[INFO] 2021-09-06 08:42:10 - Training neural network ...
[WARNING] 2021-09-06 08:42:11 - Layer neural_network_model is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because its dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

[WARNING] 2021-09-06 08:42:19 - From /home/arnaud/.conda/envs/icdm2021/lib/python3.7/site-packages/tensorflow/python/ops/summary_ops_v2.py:1203: start (from tensorflow.python.eager.profiler) is deprecated and will be removed after 2020-07-01.
Instructions for updating:
use `tf.profiler.experimental.start` instead.
[WARNING] 2021-09-06 08:42:20 - From /home/arnaud/.conda/envs/icdm2021/lib/python3.7/site-packages/tensorflow/python/ops/summary_ops_v2.py:1259: stop (from tensorflow.python.eager.profiler) is deprecated and will be removed after 2020-07-01.
Instructions for updating:
use `tf.profiler.experimental.stop` instead.
[WARNING] 2021-09-06 08:42:20 - From /home/arnaud/.conda/envs/icdm2021/lib/python3.7/site-packages/tensorflow/python/ops/summary_ops_v2.py:1259: save (from tensorflow.python.eager.profiler) is deprecated and will be removed after 2020-07-01.
Instructions for updating:
`tf.python.eager.profiler` has deprecated, use `tf.profiler` instead.
[WARNING] 2021-09-06 08:42:20 - From /home/arnaud/.conda/envs/icdm2021/lib/python3.7/site-packages/tensorflow/python/eager/profiler.py:151: maybe_create_event_file (from tensorflow.python.eager.profiler) is deprecated and will be removed after 2020-07-01.
Instructions for updating:
`tf.python.eager.profiler` has deprecated, use `tf.profiler` instead.
[WARNING] 2021-09-06 08:42:20 - From /home/arnaud/.conda/envs/icdm2021/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
[WARNING] 2021-09-06 08:42:20 - From /home/arnaud/.conda/envs/icdm2021/lib/python3.7/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
[INFO] 2021-09-06 08:42:20 - Assets written to: ./saved_models/mlp_lycos-ids2017/assets
[INFO] 2021-09-06 08:42:30 - Assets written to: ./saved_models/mlp_lycos-ids2017/assets
[INFO] 2021-09-06 08:42:40 - Assets written to: ./saved_models/mlp_lycos-ids2017/assets
[INFO] 2021-09-06 08:43:35 - Assets written to: ./saved_models/mlp_lycos-ids2017/assets
[INFO] 2021-09-06 08:44:03 - Assets written to: ./saved_models/mlp_lycos-ids2017/assets
[INFO] 2021-09-06 08:44:13 - Assets written to: ./saved_models/mlp_lycos-ids2017/assets
[INFO] 2021-09-06 08:45:44 - Assets written to: ./saved_models/mlp_lycos-ids2017/assets
[INFO] 2021-09-06 08:46:02 - MLP training time: 0:03:51.438189
[INFO] 2021-09-06 08:46:02 - Training done
[INFO] 2021-09-06 08:46:02 - Inference ...
[INFO] 2021-09-06 08:46:03 - Results:
[INFO] 2021-09-06 08:46:03 -  ********** ./datasets/lycos-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 08:46:03 - Simplified confusion matrix
[INFO] 2021-09-06 08:46:03 - row=true labels (alphabet. order)
[INFO] 2021-09-06 08:46:03 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 08:46:03 - [[110027      0    131]
 [     1    182      0]
 [     0  23920      0]
 [     4   1683      4]
 [     2  39731     14]
 [     5   1187     24]
 [     5   1398     15]
 [     2    998      0]
 [     0      2      0]
 [     5  39727      0]
 [     3    735      1]
 [   305     34      1]
 [     2      0      1]
 [   159      4      0]]
[INFO] 2021-09-06 08:46:03 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 08:46:03 -   Attack  Benign
[INFO] 2021-09-06 08:46:03 - [[109661    493]
 [   131 110027]]
[INFO] 2021-09-06 08:46:03 - overall cost: 0
[INFO] 2021-09-06 08:46:03 - true positive: 109661
[INFO] 2021-09-06 08:46:03 - false positive: 131
[INFO] 2021-09-06 08:46:03 - false negative: 493
[INFO] 2021-09-06 08:46:03 - true negative: 110027
[INFO] 2021-09-06 08:46:03 - true negative rate: 0.998811
[INFO] 2021-09-06 08:46:03 - false positive rate: 0.001189
[INFO] 2021-09-06 08:46:03 - recall: 0.995524
[INFO] 2021-09-06 08:46:03 - precision: 0.998807
[INFO] 2021-09-06 08:46:03 - accuracy: 0.997168
[INFO] 2021-09-06 08:46:03 - f1_score: 0.997163
[INFO] 2021-09-06 08:46:03 - MCC: 0.994341
[INFO] 2021-09-06 08:46:03 - ------------------------------------------
[INFO] 2021-09-06 08:46:03 - Linear Discriminant Analysis
[INFO] 2021-09-06 08:46:03 - Training ...
[INFO] 2021-09-06 08:46:08 - Inference ...
[INFO] 2021-09-06 08:46:08 - Results:
[INFO] 2021-09-06 08:46:08 -  ********** ./datasets/lycos-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 08:46:08 - Simplified confusion matrix
[INFO] 2021-09-06 08:46:08 - row=true labels (alphabet. order)
[INFO] 2021-09-06 08:46:08 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 08:46:08 - [[103159      0   6999]
 [   171     12      0]
 [     0  23916      4]
 [    92   1548     51]
 [     1  39451    295]
 [     0    984    232]
 [   181   1127    110]
 [     4    996      0]
 [     0      2      0]
 [    32  39438    262]
 [    11    727      1]
 [    14    326      0]
 [     2      1      0]
 [     0      4    159]]
[INFO] 2021-09-06 08:46:08 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 08:46:08 -   Attack  Benign
[INFO] 2021-09-06 08:46:08 - [[109646    508]
 [  6999 103159]]
[INFO] 2021-09-06 08:46:08 - overall cost: 0
[INFO] 2021-09-06 08:46:08 - true positive: 109646
[INFO] 2021-09-06 08:46:08 - false positive: 6999
[INFO] 2021-09-06 08:46:08 - false negative: 508
[INFO] 2021-09-06 08:46:08 - true negative: 103159
[INFO] 2021-09-06 08:46:08 - true negative rate: 0.936464
[INFO] 2021-09-06 08:46:08 - false positive rate: 0.063536
[INFO] 2021-09-06 08:46:08 - recall: 0.995388
[INFO] 2021-09-06 08:46:08 - precision: 0.939997
[INFO] 2021-09-06 08:46:08 - accuracy: 0.965926
[INFO] 2021-09-06 08:46:08 - f1_score: 0.966900
[INFO] 2021-09-06 08:46:08 - MCC: 0.933473
[INFO] 2021-09-06 08:46:08 - ------------------------------------------
[INFO] 2021-09-06 08:46:08 - Quadratic Discriminant Analysis
[INFO] 2021-09-06 08:46:08 - Training ...
[INFO] 2021-09-06 08:46:11 - Inference ...
[INFO] 2021-09-06 08:46:14 - Results:
[INFO] 2021-09-06 08:46:14 -  ********** ./datasets/lycos-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 08:46:14 - Simplified confusion matrix
[INFO] 2021-09-06 08:46:14 - row=true labels (alphabet. order)
[INFO] 2021-09-06 08:46:14 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 08:46:14 - [[110075      0     83]
 [     4    179      0]
 [    15  23905      0]
 [     1   1687      3]
 [   136  39607      4]
 [    18   1151     47]
 [     7   1400     11]
 [     4    996      0]
 [     2      0      0]
 [    85  39641      6]
 [    13    726      0]
 [     4     32    304]
 [     0      0      3]
 [     4    159      0]]
[INFO] 2021-09-06 08:46:14 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 08:46:14 -   Attack  Benign
[INFO] 2021-09-06 08:46:14 - [[109861    293]
 [    83 110075]]
[INFO] 2021-09-06 08:46:14 - overall cost: 0
[INFO] 2021-09-06 08:46:14 - true positive: 109861
[INFO] 2021-09-06 08:46:14 - false positive: 83
[INFO] 2021-09-06 08:46:14 - false negative: 293
[INFO] 2021-09-06 08:46:14 - true negative: 110075
[INFO] 2021-09-06 08:46:14 - true negative rate: 0.999247
[INFO] 2021-09-06 08:46:14 - false positive rate: 0.000753
[INFO] 2021-09-06 08:46:14 - recall: 0.997340
[INFO] 2021-09-06 08:46:14 - precision: 0.999245
[INFO] 2021-09-06 08:46:14 - accuracy: 0.998293
[INFO] 2021-09-06 08:46:14 - f1_score: 0.998292
[INFO] 2021-09-06 08:46:14 - MCC: 0.996588
[INFO] 2021-09-06 08:46:14 - ------------------------------------------
[INFO] 2021-09-06 08:46:14 - SVM
[INFO] 2021-09-06 08:46:14 - Training ...
[INFO] 2021-09-06 08:51:51 - Inference ...
[INFO] 2021-09-06 08:51:51 - Results:
[INFO] 2021-09-06 08:51:51 -  ********** ./datasets/lycos-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 08:51:51 - Simplified confusion matrix
[INFO] 2021-09-06 08:51:51 - row=true labels (alphabet. order)
[INFO] 2021-09-06 08:51:51 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 08:51:51 - [[109734      0    424]
 [    12    171      0]
 [     0  23916      4]
 [    45   1643      3]
 [     5  39731     11]
 [    13   1169     34]
 [    45   1344     29]
 [     1    997      2]
 [     2      0      0]
 [    33  39684     15]
 [    10    728      1]
 [   334      6      0]
 [     2      0      1]
 [   163      0      0]]
[INFO] 2021-09-06 08:51:51 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 08:51:51 -   Attack  Benign
[INFO] 2021-09-06 08:51:51 - [[109489    665]
 [   424 109734]]
[INFO] 2021-09-06 08:51:51 - overall cost: 0
[INFO] 2021-09-06 08:51:51 - true positive: 109489
[INFO] 2021-09-06 08:51:51 - false positive: 424
[INFO] 2021-09-06 08:51:51 - false negative: 665
[INFO] 2021-09-06 08:51:51 - true negative: 109734
[INFO] 2021-09-06 08:51:51 - true negative rate: 0.996151
[INFO] 2021-09-06 08:51:51 - false positive rate: 0.003849
[INFO] 2021-09-06 08:51:51 - recall: 0.993963
[INFO] 2021-09-06 08:51:51 - precision: 0.996142
[INFO] 2021-09-06 08:51:51 - accuracy: 0.995057
[INFO] 2021-09-06 08:51:51 - f1_score: 0.995052
[INFO] 2021-09-06 08:51:51 - MCC: 0.990116
[INFO] 2021-09-06 08:51:51 - ------------------------------------------
[INFO] 2021-09-06 08:51:51 - k-Nearest Neighbors
[INFO] 2021-09-06 08:51:51 - Training ...
[INFO] 2021-09-06 08:51:51 - Inference ...
[INFO] 2021-09-06 09:17:10 - Results:
[INFO] 2021-09-06 09:17:10 -  ********** ./datasets/lycos-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:17:10 - Simplified confusion matrix
[INFO] 2021-09-06 09:17:10 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:17:10 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:17:10 - [[110053      0    105]
 [     2    181      0]
 [     0  23920      0]
 [     2   1679     10]
 [     7  39733      7]
 [    19   1182     15]
 [     4   1404     10]
 [     1    999      0]
 [     0      2      0]
 [     4  39725      3]
 [     5    734      0]
 [     1    275     64]
 [     2      0      1]
 [     0     50    113]]
[INFO] 2021-09-06 09:17:10 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:17:10 -   Attack  Benign
[INFO] 2021-09-06 09:17:10 - [[110107     47]
 [   105 110053]]
[INFO] 2021-09-06 09:17:10 - overall cost: 0
[INFO] 2021-09-06 09:17:10 - true positive: 110107
[INFO] 2021-09-06 09:17:10 - false positive: 105
[INFO] 2021-09-06 09:17:10 - false negative: 47
[INFO] 2021-09-06 09:17:10 - true negative: 110053
[INFO] 2021-09-06 09:17:10 - true negative rate: 0.999047
[INFO] 2021-09-06 09:17:10 - false positive rate: 0.000953
[INFO] 2021-09-06 09:17:10 - recall: 0.999573
[INFO] 2021-09-06 09:17:10 - precision: 0.999047
[INFO] 2021-09-06 09:17:10 - accuracy: 0.999310
[INFO] 2021-09-06 09:17:10 - f1_score: 0.999310
[INFO] 2021-09-06 09:17:10 - MCC: 0.998620
[INFO] 2021-09-06 09:17:10 - ------------------------------------------
[INFO] 2021-09-06 09:17:10 - Decision Tree
[INFO] 2021-09-06 09:17:10 - Training ...
[INFO] 2021-09-06 09:17:20 - Inference ...
[INFO] 2021-09-06 09:17:20 - Results:
[INFO] 2021-09-06 09:17:20 -  ********** ./datasets/lycos-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:17:20 - Simplified confusion matrix
[INFO] 2021-09-06 09:17:20 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:17:20 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:17:20 - [[110069      0     89]
 [     2    181      0]
 [     0  23920      0]
 [    52   1635      4]
 [     6  39735      6]
 [     8   1190     18]
 [     2   1410      6]
 [     0   1000      0]
 [     0      2      0]
 [     1  39729      2]
 [     3    736      0]
 [     4    237     99]
 [     2      0      1]
 [     1     56    106]]
[INFO] 2021-09-06 09:17:20 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:17:20 -   Attack  Benign
[INFO] 2021-09-06 09:17:20 - [[110073     81]
 [    89 110069]]
[INFO] 2021-09-06 09:17:20 - overall cost: 0
[INFO] 2021-09-06 09:17:20 - true positive: 110073
[INFO] 2021-09-06 09:17:20 - false positive: 89
[INFO] 2021-09-06 09:17:20 - false negative: 81
[INFO] 2021-09-06 09:17:20 - true negative: 110069
[INFO] 2021-09-06 09:17:20 - true negative rate: 0.999192
[INFO] 2021-09-06 09:17:20 - false positive rate: 0.000808
[INFO] 2021-09-06 09:17:20 - recall: 0.999265
[INFO] 2021-09-06 09:17:20 - precision: 0.999192
[INFO] 2021-09-06 09:17:20 - accuracy: 0.999228
[INFO] 2021-09-06 09:17:20 - f1_score: 0.999228
[INFO] 2021-09-06 09:17:20 - MCC: 0.998457
[INFO] 2021-09-06 09:17:20 - ------------------------------------------
[INFO] 2021-09-06 09:17:20 - Random Forest
[INFO] 2021-09-06 09:17:20 - Training ...
[INFO] 2021-09-06 09:18:25 - Inference ...
[INFO] 2021-09-06 09:18:27 - Results:
[INFO] 2021-09-06 09:18:27 -  ********** ./datasets/lycos-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:18:27 - Simplified confusion matrix
[INFO] 2021-09-06 09:18:27 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:18:27 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:18:27 - [[110097      0     61]
 [     0    183      0]
 [     0  23920      0]
 [    10   1678      3]
 [     3  39738      6]
 [     4   1203      9]
 [     3   1412      3]
 [     0   1000      0]
 [     0      2      0]
 [     2  39728      2]
 [     2    737      0]
 [     1    313     26]
 [     2      0      1]
 [     0     20    143]]
[INFO] 2021-09-06 09:18:27 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:18:27 -   Attack  Benign
[INFO] 2021-09-06 09:18:27 - [[110127     27]
 [    61 110097]]
[INFO] 2021-09-06 09:18:27 - overall cost: 0
[INFO] 2021-09-06 09:18:27 - true positive: 110127
[INFO] 2021-09-06 09:18:27 - false positive: 61
[INFO] 2021-09-06 09:18:27 - false negative: 27
[INFO] 2021-09-06 09:18:27 - true negative: 110097
[INFO] 2021-09-06 09:18:27 - true negative rate: 0.999446
[INFO] 2021-09-06 09:18:27 - false positive rate: 0.000554
[INFO] 2021-09-06 09:18:27 - recall: 0.999755
[INFO] 2021-09-06 09:18:27 - precision: 0.999446
[INFO] 2021-09-06 09:18:27 - accuracy: 0.999601
[INFO] 2021-09-06 09:18:27 - f1_score: 0.999601
[INFO] 2021-09-06 09:18:27 - MCC: 0.999201
[INFO] 2021-09-06 09:18:27 -             Metrics            MLP            LDA            QDA            SVM           k-NN             DT             RF
0                TP  109661.000000  109646.000000  109861.000000  109489.000000  110107.000000  110073.000000  110127.000000
1                FP     131.000000    6999.000000      83.000000     424.000000     105.000000      89.000000      61.000000
2                FN     493.000000     508.000000     293.000000     665.000000      47.000000      81.000000      27.000000
3                TN  110027.000000  103159.000000  110075.000000  109734.000000  110053.000000  110069.000000  110097.000000
4               TNR       0.998811       0.936464       0.999247       0.996151       0.999047       0.999192       0.999446
5               FPR       0.001189       0.063536       0.000753       0.003849       0.000953       0.000808       0.000554
6            Recall       0.995524       0.995388       0.997340       0.993963       0.999573       0.999265       0.999755
7         Precision       0.998807       0.939997       0.999245       0.996142       0.999047       0.999192       0.999446
8          Accuracy       0.997168       0.965926       0.998293       0.995057       0.999310       0.999228       0.999601
9          F1_score       0.997163       0.966900       0.998292       0.995052       0.999310       0.999228       0.999601
10              MCC       0.994341       0.933473       0.996588       0.990116       0.998620       0.998457       0.999201
11    Training time     231.748182       4.873787       3.138267     336.908421       0.036538       9.879229      64.731439
12  Prediction time       0.800962       0.117566       2.781985       0.070916    1519.312237       0.036413       1.849710
[INFO] 2021-09-06 09:18:27 - ------------------------------------------
[INFO] 2021-09-06 09:18:27 - MLP
[INFO] 2021-09-06 09:18:27 - Training ...
[INFO] 2021-09-06 09:18:27 - Creating neural network ...
[INFO] 2021-09-06 09:18:27 - Model name: mlp_cic-ids2017
[INFO] 2021-09-06 09:18:27 - n_epochs: 25
[INFO] 2021-09-06 09:18:27 - activation function: selu
[INFO] 2021-09-06 09:18:27 - dropout_rate: 0.20886178816521117
[INFO] 2021-09-06 09:18:27 - optim_params: [0.0003590920789688343, 0.8662527597085028, 0.999]
[INFO] 2021-09-06 09:18:27 - Training neural network ...
[WARNING] 2021-09-06 09:18:28 - Layer neural_network_model_1 is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because its dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

[INFO] 2021-09-06 09:18:37 - Assets written to: ./saved_models/mlp_cic-ids2017/assets
[INFO] 2021-09-06 09:18:47 - Assets written to: ./saved_models/mlp_cic-ids2017/assets
[INFO] 2021-09-06 09:20:37 - Assets written to: ./saved_models/mlp_cic-ids2017/assets
[INFO] 2021-09-06 09:21:45 - Assets written to: ./saved_models/mlp_cic-ids2017/assets
[INFO] 2021-09-06 09:22:37 - Assets written to: ./saved_models/mlp_cic-ids2017/assets
[INFO] 2021-09-06 09:22:37 - MLP training time: 0:04:09.912554
[INFO] 2021-09-06 09:22:37 - Training done
[INFO] 2021-09-06 09:22:37 - Inference ...
[INFO] 2021-09-06 09:22:38 - Results:
[INFO] 2021-09-06 09:22:38 -  ********** ./datasets/cic-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:22:38 - Simplified confusion matrix
[INFO] 2021-09-06 09:22:38 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:22:38 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:22:38 - [[108413      0   1745]
 [    72    111      0]
 [    12  23884     24]
 [    68   1613     10]
 [    24  39720      3]
 [     9   1188     19]
 [    23   1365     30]
 [     0    998      2]
 [     0      2      0]
 [     1  39716     15]
 [    21    714      4]
 [     3    303     34]
 [     2      0      1]
 [     1      0    162]]
[INFO] 2021-09-06 09:22:38 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:22:38 -   Attack  Benign
[INFO] 2021-09-06 09:22:38 - [[109918    236]
 [  1745 108413]]
[INFO] 2021-09-06 09:22:38 - overall cost: 0
[INFO] 2021-09-06 09:22:38 - true positive: 109918
[INFO] 2021-09-06 09:22:38 - false positive: 1745
[INFO] 2021-09-06 09:22:38 - false negative: 236
[INFO] 2021-09-06 09:22:38 - true negative: 108413
[INFO] 2021-09-06 09:22:38 - true negative rate: 0.984159
[INFO] 2021-09-06 09:22:38 - false positive rate: 0.015841
[INFO] 2021-09-06 09:22:38 - recall: 0.997858
[INFO] 2021-09-06 09:22:38 - precision: 0.984373
[INFO] 2021-09-06 09:22:38 - accuracy: 0.991008
[INFO] 2021-09-06 09:22:38 - f1_score: 0.991069
[INFO] 2021-09-06 09:22:38 - MCC: 0.982109
[INFO] 2021-09-06 09:22:38 - ------------------------------------------
[INFO] 2021-09-06 09:22:38 - Linear Discriminant Analysis
[INFO] 2021-09-06 09:22:38 - Training ...
[INFO] 2021-09-06 09:22:43 - Inference ...
[INFO] 2021-09-06 09:22:43 - Results:
[INFO] 2021-09-06 09:22:43 -  ********** ./datasets/cic-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:22:43 - Simplified confusion matrix
[INFO] 2021-09-06 09:22:43 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:22:43 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:22:43 - [[85787     0 24371]
 [   66     4   113]
 [   13 22949   958]
 [  162  1443    86]
 [ 1533 32019  6195]
 [   24   922   270]
 [    3   724   691]
 [    0   480   520]
 [    0     2     0]
 [    1 39426   305]
 [    5   723    11]
 [   29   277    34]
 [    2     0     1]
 [    2     0   161]]
[INFO] 2021-09-06 09:22:43 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:22:43 -   Attack  Benign
[INFO] 2021-09-06 09:22:43 - [[108314   1840]
 [ 24371  85787]]
[INFO] 2021-09-06 09:22:43 - overall cost: 0
[INFO] 2021-09-06 09:22:43 - true positive: 108314
[INFO] 2021-09-06 09:22:43 - false positive: 24371
[INFO] 2021-09-06 09:22:43 - false negative: 1840
[INFO] 2021-09-06 09:22:43 - true negative: 85787
[INFO] 2021-09-06 09:22:43 - true negative rate: 0.778763
[INFO] 2021-09-06 09:22:43 - false positive rate: 0.221237
[INFO] 2021-09-06 09:22:43 - recall: 0.983296
[INFO] 2021-09-06 09:22:43 - precision: 0.816324
[INFO] 2021-09-06 09:22:43 - accuracy: 0.881028
[INFO] 2021-09-06 09:22:43 - f1_score: 0.892064
[INFO] 2021-09-06 09:22:43 - MCC: 0.778515
[INFO] 2021-09-06 09:22:43 - ------------------------------------------
[INFO] 2021-09-06 09:22:43 - Quadratic Discriminant Analysis
[INFO] 2021-09-06 09:22:43 - Training ...
[INFO] 2021-09-06 09:22:46 - Inference ...
[INFO] 2021-09-06 09:22:48 - Results:
[INFO] 2021-09-06 09:22:48 -  ********** ./datasets/cic-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:22:48 - Simplified confusion matrix
[INFO] 2021-09-06 09:22:48 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:22:48 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:22:48 - [[105583      0   4575]
 [     5    178      0]
 [    48  23868      4]
 [     2   1688      1]
 [   122  39602     23]
 [    11   1160     45]
 [     6   1405      7]
 [     2    998      0]
 [     2      0      0]
 [   234  39467     31]
 [    14    725      0]
 [     7     60    273]
 [     1      0      2]
 [     3    158      2]]
[INFO] 2021-09-06 09:22:48 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:22:48 -   Attack  Benign
[INFO] 2021-09-06 09:22:48 - [[109697    457]
 [  4575 105583]]
[INFO] 2021-09-06 09:22:48 - overall cost: 0
[INFO] 2021-09-06 09:22:48 - true positive: 109697
[INFO] 2021-09-06 09:22:48 - false positive: 4575
[INFO] 2021-09-06 09:22:48 - false negative: 457
[INFO] 2021-09-06 09:22:48 - true negative: 105583
[INFO] 2021-09-06 09:22:48 - true negative rate: 0.958469
[INFO] 2021-09-06 09:22:48 - false positive rate: 0.041531
[INFO] 2021-09-06 09:22:48 - recall: 0.995851
[INFO] 2021-09-06 09:22:48 - precision: 0.959964
[INFO] 2021-09-06 09:22:48 - accuracy: 0.977160
[INFO] 2021-09-06 09:22:48 - f1_score: 0.977578
[INFO] 2021-09-06 09:22:48 - MCC: 0.954987
[INFO] 2021-09-06 09:22:48 - ------------------------------------------
[INFO] 2021-09-06 09:22:48 - SVM
[INFO] 2021-09-06 09:22:48 - Training ...
[INFO] 2021-09-06 09:30:33 - Inference ...
[INFO] 2021-09-06 09:30:33 - Results:
[INFO] 2021-09-06 09:30:33 -  ********** ./datasets/cic-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:30:33 - Simplified confusion matrix
[INFO] 2021-09-06 09:30:33 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:30:33 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:30:33 - [[105390      0   4768]
 [   141      3     39]
 [    32  23870     18]
 [   171   1485     35]
 [   107  39597     43]
 [   151   1043     22]
 [   244   1155     19]
 [     1    999      0]
 [     0      2      0]
 [   158  39539     35]
 [   374    361      4]
 [   340      0      0]
 [     3      0      0]
 [   156      0      7]]
[INFO] 2021-09-06 09:30:33 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:30:33 -   Attack  Benign
[INFO] 2021-09-06 09:30:33 - [[108276   1878]
 [  4768 105390]]
[INFO] 2021-09-06 09:30:33 - overall cost: 0
[INFO] 2021-09-06 09:30:33 - true positive: 108276
[INFO] 2021-09-06 09:30:33 - false positive: 4768
[INFO] 2021-09-06 09:30:33 - false negative: 1878
[INFO] 2021-09-06 09:30:33 - true negative: 105390
[INFO] 2021-09-06 09:30:33 - true negative rate: 0.956717
[INFO] 2021-09-06 09:30:33 - false positive rate: 0.043283
[INFO] 2021-09-06 09:30:33 - recall: 0.982951
[INFO] 2021-09-06 09:30:33 - precision: 0.957822
[INFO] 2021-09-06 09:30:33 - accuracy: 0.969834
[INFO] 2021-09-06 09:30:33 - f1_score: 0.970224
[INFO] 2021-09-06 09:30:33 - MCC: 0.939991
[INFO] 2021-09-06 09:30:33 - ------------------------------------------
[INFO] 2021-09-06 09:30:33 - k-Nearest Neighbors
[INFO] 2021-09-06 09:30:33 - Training ...
[INFO] 2021-09-06 09:30:33 - Inference ...
[INFO] 2021-09-06 09:58:12 - Results:
[INFO] 2021-09-06 09:58:12 -  ********** ./datasets/cic-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:58:12 - Simplified confusion matrix
[INFO] 2021-09-06 09:58:12 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:58:12 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:58:12 - [[108899      0   1259]
 [    64    119      0]
 [     6  23904     10]
 [     9   1676      6]
 [    74  39662     11]
 [    11   1187     18]
 [     6   1407      5]
 [     1    999      0]
 [     0      2      0]
 [    86  39636     10]
 [    10    726      3]
 [     3    262     75]
 [     2      0      1]
 [     1     60    102]]
[INFO] 2021-09-06 09:58:12 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:58:12 -   Attack  Benign
[INFO] 2021-09-06 09:58:12 - [[109881    273]
 [  1259 108899]]
[INFO] 2021-09-06 09:58:12 - overall cost: 0
[INFO] 2021-09-06 09:58:12 - true positive: 109881
[INFO] 2021-09-06 09:58:12 - false positive: 1259
[INFO] 2021-09-06 09:58:12 - false negative: 273
[INFO] 2021-09-06 09:58:12 - true negative: 108899
[INFO] 2021-09-06 09:58:12 - true negative rate: 0.988571
[INFO] 2021-09-06 09:58:12 - false positive rate: 0.011429
[INFO] 2021-09-06 09:58:12 - recall: 0.997522
[INFO] 2021-09-06 09:58:12 - precision: 0.988672
[INFO] 2021-09-06 09:58:12 - accuracy: 0.993046
[INFO] 2021-09-06 09:58:12 - f1_score: 0.993077
[INFO] 2021-09-06 09:58:12 - MCC: 0.986132
[INFO] 2021-09-06 09:58:12 - ------------------------------------------
[INFO] 2021-09-06 09:58:12 - Decision Tree
[INFO] 2021-09-06 09:58:12 - Training ...
[INFO] 2021-09-06 09:58:23 - Inference ...
[INFO] 2021-09-06 09:58:23 - Results:
[INFO] 2021-09-06 09:58:23 -  ********** ./datasets/cic-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:58:23 - Simplified confusion matrix
[INFO] 2021-09-06 09:58:23 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:58:23 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:58:23 - [[110016      0    142]
 [    25    158      0]
 [     5  23912      3]
 [     0   1683      8]
 [    17  39723      7]
 [     2   1203     11]
 [     2   1404     12]
 [     0   1000      0]
 [     0      2      0]
 [    57  39666      9]
 [     4    735      0]
 [     4    236    100]
 [     2      1      0]
 [     1     69     93]]
[INFO] 2021-09-06 09:58:23 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:58:23 -   Attack  Benign
[INFO] 2021-09-06 09:58:23 - [[110035    119]
 [   142 110016]]
[INFO] 2021-09-06 09:58:23 - overall cost: 0
[INFO] 2021-09-06 09:58:23 - true positive: 110035
[INFO] 2021-09-06 09:58:23 - false positive: 142
[INFO] 2021-09-06 09:58:23 - false negative: 119
[INFO] 2021-09-06 09:58:23 - true negative: 110016
[INFO] 2021-09-06 09:58:23 - true negative rate: 0.998711
[INFO] 2021-09-06 09:58:23 - false positive rate: 0.001289
[INFO] 2021-09-06 09:58:23 - recall: 0.998920
[INFO] 2021-09-06 09:58:23 - precision: 0.998711
[INFO] 2021-09-06 09:58:23 - accuracy: 0.998815
[INFO] 2021-09-06 09:58:23 - f1_score: 0.998815
[INFO] 2021-09-06 09:58:23 - MCC: 0.997631
[INFO] 2021-09-06 09:58:23 - ------------------------------------------
[INFO] 2021-09-06 09:58:23 - Random Forest
[INFO] 2021-09-06 09:58:23 - Training ...
[INFO] 2021-09-06 09:59:34 - Inference ...
[INFO] 2021-09-06 09:59:37 - Results:
[INFO] 2021-09-06 09:59:37 -  ********** ./datasets/cic-ids2017/test_set.parquet  **********
[INFO] 2021-09-06 09:59:37 - Simplified confusion matrix
[INFO] 2021-09-06 09:59:37 - row=true labels (alphabet. order)
[INFO] 2021-09-06 09:59:37 - col=Benign | Correct Attack | Other Attack:
[INFO] 2021-09-06 09:59:37 - [[110051      0    107]
 [    47    136      0]
 [     9  23908      3]
 [     1   1683      7]
 [    15  39730      2]
 [     4   1203      9]
 [     4   1411      3]
 [     0   1000      0]
 [     0      2      0]
 [     2  39720     10]
 [     5    733      1]
 [     4    275     61]
 [     3      0      0]
 [     8     47    108]]
[INFO] 2021-09-06 09:59:37 - Binary confusion matrix (row=true labels ; col=predicted labels)
[INFO] 2021-09-06 09:59:37 -   Attack  Benign
[INFO] 2021-09-06 09:59:37 - [[110052    102]
 [   107 110051]]
[INFO] 2021-09-06 09:59:37 - overall cost: 0
[INFO] 2021-09-06 09:59:37 - true positive: 110052
[INFO] 2021-09-06 09:59:37 - false positive: 107
[INFO] 2021-09-06 09:59:37 - false negative: 102
[INFO] 2021-09-06 09:59:37 - true negative: 110051
[INFO] 2021-09-06 09:59:37 - true negative rate: 0.999029
[INFO] 2021-09-06 09:59:37 - false positive rate: 0.000971
[INFO] 2021-09-06 09:59:37 - recall: 0.999074
[INFO] 2021-09-06 09:59:37 - precision: 0.999029
[INFO] 2021-09-06 09:59:37 - accuracy: 0.999051
[INFO] 2021-09-06 09:59:37 - f1_score: 0.999051
[INFO] 2021-09-06 09:59:37 - MCC: 0.998103
[INFO] 2021-09-06 09:59:37 -             Metrics            MLP            LDA            QDA            SVM           k-NN             DT             RF
0                TP  109918.000000  108314.000000  109697.000000  108276.000000  109881.000000  110035.000000  110052.000000
1                FP    1745.000000   24371.000000    4575.000000    4768.000000    1259.000000     142.000000     107.000000
2                FN     236.000000    1840.000000     457.000000    1878.000000     273.000000     119.000000     102.000000
3                TN  108413.000000   85787.000000  105583.000000  105390.000000  108899.000000  110016.000000  110051.000000
4               TNR       0.984159       0.778763       0.958469       0.956717       0.988571       0.998711       0.999029
5               FPR       0.015841       0.221237       0.041531       0.043283       0.011429       0.001289       0.000971
6            Recall       0.997858       0.983296       0.995851       0.982951       0.997522       0.998920       0.999074
7         Precision       0.984373       0.816324       0.959964       0.957822       0.988672       0.998711       0.999029
8          Accuracy       0.991008       0.881028       0.977160       0.969834       0.993046       0.998815       0.999051
9          F1_score       0.991069       0.892064       0.977578       0.970224       0.993077       0.998815       0.999051
10              MCC       0.982109       0.778515       0.954987       0.939991       0.986132       0.997631       0.998103
11    Training time     250.205056       4.413844       2.808599     464.574875       0.034924      10.887574      70.867581
12  Prediction time       0.737330       0.107066       2.631483       0.072294    1658.950243       0.042926       2.266551
[INFO] 2021-09-06 09:59:37 - ----Program finished----
