# LYCOS-IDS2017

This project creates a new dataset from CIC-IDS2017 PCAP files.

## Installation
* All python packages necessary to run this program are listed in requirements.txt and can be installed with pip or with conda.
* Retrieve code from Github  
  git clone https://github.com/17204612710214/lycos-ids2017.git  
  cd lycos-ids2017  
* Retrieve CIC-IDS2017 CSV files from https://www.unb.ca/cic/datasets/ids-2017.html (download link at bottom page)    
  Put CSV files in lycos-ids2017/cicids2017/csv_files/ 
  For convenience, they are provided in compressed format   
  cd cicids2017/csv_files/  
  unzip '\*.zip'  
  cd ..  
* Put CSV generated by LycoSTand in lycos-ids2017/pcap_lycos/    
  For convenience, they are provided in compressed format   
  cd pcap_lycos  
  unzip '\*.zip'  
  cd .. 

## Execution
* Put labels to all flows of the CSV generated by LycoSTand.    
  python labelling.py
* Create training/cross-validation/test sets.   
  python create_datasets.py  
* Launch analysis of performance    
  python analysis.py  

## Results

Results reported below are extracted from excel files automatically generated by the program.

### LYCOS-IDS2017

| **Metrics**         | **MLP**           | **LDA**           | **QDA**           | **SVM**           | **k-NN**          | **DT**            | **RF**            |
| ------------------- | ----------------- | ----------------- | ----------------- | ----------------- | ----------------- | ----------------- | ----------------- |
| **TP**              | 109661            | 109646            | 109861            | 109489            | 110107            | 110073            | 110127            |
| **FP**              | 131               | 6999              | 83                | 424               | 105               | 89                | 61                |
| **FN**              | 493               | 508               | 293               | 665               | 47                | 81                | 27                |
| **TN**              | 110027            | 103159            | 110075            | 109734            | 110053            | 110069            | 110097            |
| **TNR**             | 0.998810799034115 | 0.936463988089835 | 0.999246536792607 | 0.996150983133318 | 0.999046823653298 | 0.999192069572796 | 0.999446249931916 |
| **FPR**             | 0.001189200965885 | 0.063536011910166 | 0.000753463207393 | 0.003849016866682 | 0.000953176346702 | 0.000807930427205 | 0.000553750068084 |
| **Recall**          | 0.995524447591554 | 0.995388274597382 | 0.997340087513844 | 0.993962997258384 | 0.999573324618262 | 0.999264665831472 | 0.999754888610491 |
| **Precision**       | 0.998806834742057 | 0.939997428093789 | 0.999245070217565 | 0.996142403537343 | 0.999047290676151 | 0.99919209890888  | 0.99944640069699  |
| **Accuracy**        | 0.997167653146447 | 0.965925596426886 | 0.998293329460038 | 0.995057010058463 | 0.999310069356186 | 0.999228367043102 | 0.999600566469371 |
| **F1\_score**       | 0.997162939994362 | 0.966900206791035 | 0.99829167007424  | 0.995051507041038 | 0.999310238421535 | 0.99922838105267  | 0.999600620853038 |
| **MCC**             | 0.994340675124347 | 0.933473282560392 | 0.996588469759575 | 0.990116389318452 | 0.998620277148688 | 0.998456736720804 | 0.999201180538299 |
| **Training time**   | 231.748182        | 4.873787          | 3.138267          | 336.908421        | 0.036538          | 9.879229          | 64.731439         |
| **Prediction time** | 0.800962          | 0.117566          | 2.781985          | 0.070916          | 1519.312237       | 0.036413          | 1.84971           |

### CIC-IDS2017

| **Metrics**         | **MLP**           | **LDA**           | **QDA**           | **SVM**           | **k-NN**          | **DT**            | **RF**            |
| ------------------- | ----------------- | ----------------- | ----------------- | ----------------- | ----------------- | ----------------- | ----------------- |
| **TP**              | 109918            | 108314            | 109697            | 108276            | 109881            | 110035            | 110052            |
| **FP**              | 1745              | 24371             | 4575              | 4768              | 1259              | 142               | 107               |
| **FN**              | 236               | 1840              | 457               | 1878              | 273               | 119               | 102               |
| **TN**              | 108413            | 85787             | 105583            | 105390            | 108899            | 110016            | 110051            |
| **TNR**             | 0.98415911690481  | 0.778763230995479 | 0.958468744893698 | 0.95671671598976  | 0.988570961709544 | 0.99871094246446  | 0.999028667913361 |
| **FPR**             | 0.015840883095191 | 0.221236769004521 | 0.041531255106302 | 0.04328328401024  | 0.011429038290456 | 0.00128905753554  | 0.000971332086639 |
| **Recall**          | 0.997857544891697 | 0.983296112714926 | 0.995851262777566 | 0.982951141129691 | 0.997521651506073 | 0.998919694246237 | 0.999074023639632 |
| **Precision**       | 0.984372621190547 | 0.816324377284546 | 0.959963945673481 | 0.957821733130462 | 0.988671945294223 | 0.998711164762156 | 0.999028676730907 |
| **Accuracy**        | 0.991008206543448 | 0.881027815098587 | 0.977159664475834 | 0.969833690402702 | 0.993046225353135 | 0.998815316460293 | 0.999051345364756 |
| **F1\_score**       | 0.991069214713029 | 0.892064289508687 | 0.977578355449012 | 0.970223747524619 | 0.993077082975589 | 0.998815418620167 | 0.999051349670696 |
| **MCC**             | 0.982108571052937 | 0.778515141360189 | 0.954986896430506 | 0.939990963984342 | 0.986131957874979 | 0.997630654674774 | 0.998102691758628 |
| **Training time**   | 250.205056        | 4.413844          | 2.808599          | 464.574875        | 0.034924          | 10.887574         | 70.867581         |
| **Prediction time** | 0.73733           | 0.107066          | 2.631483          | 0.072294          | 1658.950243       | 0.042926          | 2.266551          |
